<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DNA: cMainData Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<h1>cMainData Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="cMainData" -->
<p>Data manipulation class.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a32132616ef24032e4e7b85f29e7b969e">__construct</a> ($strHost, $strDbName, $strUser, $strPass)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct.  <a href="#a32132616ef24032e4e7b85f29e7b969e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a947de261e970590ffdd86e6c4e6d8271">pf_getLocalMaxMinRC</a> ($numDateTZ)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets local max/min dates in Recent Changes.  <a href="#a947de261e970590ffdd86e6c4e6d8271"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#ae894b44305a308a004e2d9b243e4cf31">pf_isDateInRC</a> ($strDay, $numDateTZ)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if given date is in Recent Changes.  <a href="#ae894b44305a308a004e2d9b243e4cf31"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a3c0f3599abdabe6bda9bb73b58bea91f">pf_getPagesBasics</a> ($strDay, $numDateTZ, $isAccuracyNeeded=false)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get basic page info for DNA.  <a href="#a3c0f3599abdabe6bda9bb73b58bea91f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a69f4f4f0cfa46033c0d66cb7f360e300">pf_getPageLastLens</a> (&amp;$arrPages, $strDay, $numDateTZ)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get length of last revision for DNA.  <a href="#a69f4f4f0cfa46033c0d66cb7f360e300"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a967bc74706f3f05a28fe9ca98ed61ad1">pf_getUserInfo</a> (&amp;$arrPages)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get user info for DNA.  <a href="#a967bc74706f3f05a28fe9ca98ed61ad1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a9d04c872775b3dea44bf69d6bb387ff2">pf_getPageTitles</a> (&amp;$arrPages)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get page title for DNA.  <a href="#a9d04c872775b3dea44bf69d6bb387ff2"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a1f699bf6796a8df18c8560d1395258bc">pf_genDTStampsSQL</a> ($strDay, $numDateTZ)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate date-time stamps SQL.  <a href="#a1f699bf6796a8df18c8560d1395258bc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a1ef9cb10491e8e4b1ee95d318536ca7b">pf_getMaxMinRC</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets max/min dates in Recent Changes.  <a href="#a1ef9cb10491e8e4b1ee95d318536ca7b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#acfbf55a2b4a425fa97a4f4491e0e560f">pf_fetchAllSQL</a> ($strSQL, $pdoFetchStyle=PDO::FETCH_ASSOC)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetch all rows to an assoc array.  <a href="#acfbf55a2b4a425fa97a4f4491e0e560f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a66b67d356902020dd46c7a1748fa8c69">pf_throwSQLError</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Throw SQL Error.  <a href="#a66b67d356902020dd46c7a1748fa8c69"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1fa3127fc82f96b1436d871ef02be319"></a><!-- doxytag: member="cMainData::$db" ref="a1fa3127fc82f96b1436d871ef02be319" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a1fa3127fc82f96b1436d871ef02be319">$db</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">PDO object. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a726c82bad8f2834de7db5ab692fdd238"></a><!-- doxytag: member="cMainData::$dbSt" ref="a726c82bad8f2834de7db5ab692fdd238" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classc_main_data.html#a726c82bad8f2834de7db5ab692fdd238">$dbSt</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Last PDO Statement. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Data manipulation class. </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a32132616ef24032e4e7b85f29e7b969e"></a><!-- doxytag: member="cMainData::__construct" ref="a32132616ef24032e4e7b85f29e7b969e" args="($strHost, $strDbName, $strUser, $strPass)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>strHost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>strDbName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>strUser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>strPass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Construct. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">$strHost</td><td>Database host </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">$strDbName</td><td>Database name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">$strUser</td><td>Database user </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">$strPass</td><td>Database user password </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="acfbf55a2b4a425fa97a4f4491e0e560f"></a><!-- doxytag: member="cMainData::pf_fetchAllSQL" ref="acfbf55a2b4a425fa97a4f4491e0e560f" args="($strSQL, $pdoFetchStyle=PDO::FETCH_ASSOC)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pf_fetchAllSQL </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>strSQL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>pdoFetchStyle</em> = <code>PDO::FETCH_ASSOC</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fetch all rows to an assoc array. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">$strSQL</td><td>The query </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">$pdoFetchStyle</td><td>PDO fetch style (defaults to FETCH_ASSOC)</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>rows returned by the server</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd>PDO::fetchAll(); </dd></dl>

</div>
</div>
<a class="anchor" id="a1f699bf6796a8df18c8560d1395258bc"></a><!-- doxytag: member="cMainData::pf_genDTStampsSQL" ref="a1f699bf6796a8df18c8560d1395258bc" args="($strDay, $numDateTZ)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pf_genDTStampsSQL </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>strDay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>numDateTZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate date-time stamps SQL. </p>
<p>Generate date-time stamps SQL with column name as "{column}".</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">$strDay</td><td>The day for the select </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">$numDateTZ</td><td>A project timezone at that date</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a string of wiki-style date stamps SQL separated with OR </dd></dl>

</div>
</div>
<a class="anchor" id="a947de261e970590ffdd86e6c4e6d8271"></a><!-- doxytag: member="cMainData::pf_getLocalMaxMinRC" ref="a947de261e970590ffdd86e6c4e6d8271" args="($numDateTZ)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pf_getLocalMaxMinRC </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>numDateTZ</em>&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets local max/min dates in Recent Changes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">$numDateTZ</td><td>A project's current timezone</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>array( 'min' =&gt; almost ISO date (no 'T'), 'max' =&gt; almost ISO date (no 'T'), ) </dd></dl>

</div>
</div>
<a class="anchor" id="a1ef9cb10491e8e4b1ee95d318536ca7b"></a><!-- doxytag: member="cMainData::pf_getMaxMinRC" ref="a1ef9cb10491e8e4b1ee95d318536ca7b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pf_getMaxMinRC </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Gets max/min dates in Recent Changes. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>The times are GMT.</dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>array( 'rc_min' =&gt; wikiTimeStamp, 'rc_max' =&gt; wikiTimeStamp, ) </dd></dl>

</div>
</div>
<a class="anchor" id="a69f4f4f0cfa46033c0d66cb7f360e300"></a><!-- doxytag: member="cMainData::pf_getPageLastLens" ref="a69f4f4f0cfa46033c0d66cb7f360e300" args="(&amp;$arrPages, $strDay, $numDateTZ)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pf_getPageLastLens </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"> <em>arrPages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>strDay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>numDateTZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get length of last revision for DNA. </p>
<p>Gets length of pages at the end of the day.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">$arrPages</td><td>The array of pages containing at least page_id </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">$strDay</td><td>The day to check </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">$numDateTZ</td><td>A project timezone at that date</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>an array with key=&gt;val set to: page_id=&gt;end_len </dd></dl>

</div>
</div>
<a class="anchor" id="a3c0f3599abdabe6bda9bb73b58bea91f"></a><!-- doxytag: member="cMainData::pf_getPagesBasics" ref="a3c0f3599abdabe6bda9bb73b58bea91f" args="($strDay, $numDateTZ, $isAccuracyNeeded=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pf_getPagesBasics </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>strDay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>numDateTZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>isAccuracyNeeded</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get basic page info for DNA. </p>
<p>Gets basic pages info for the given <em>strDay</em> that where created on that day.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">$strDay</td><td>The day to check </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">$numDateTZ</td><td>A project timezone at that date </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">$isAccuracyNeeded</td><td>true if accuracy is needed (and RC must not be used)</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>$arrPages an array of pages containing: user_id, page_id, start_len </dd></dl>

</div>
</div>
<a class="anchor" id="a9d04c872775b3dea44bf69d6bb387ff2"></a><!-- doxytag: member="cMainData::pf_getPageTitles" ref="a9d04c872775b3dea44bf69d6bb387ff2" args="(&amp;$arrPages)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pf_getPageTitles </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"> <em>arrPages</em>&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get page title for DNA. </p>
<p>Gets page titles and namespace for the pages given in the pages array. Does not append this data beacuse it might be easier to refresh redirects this way.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">$arrPages</td><td>The array of pages containing at least page_id</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>an array with key=&gt;val set to: page_id=&gt;array('page_title'=&gt;..., 'page_namespace'=&gt;...) </dd></dl>

</div>
</div>
<a class="anchor" id="a967bc74706f3f05a28fe9ca98ed61ad1"></a><!-- doxytag: member="cMainData::pf_getUserInfo" ref="a967bc74706f3f05a28fe9ca98ed61ad1" args="(&amp;$arrPages)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pf_getUserInfo </td>
          <td>(</td>
          <td class="paramtype">&amp;$&#160;</td>
          <td class="paramname"> <em>arrPages</em>&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get user info for DNA. </p>
<p>Currently only gets user name for the pages given in the pages array.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">$arrPages</td><td>The array of pages containing at least user_id</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>an array with key=&gt;val set to: user_id=&gt;user_name </dd></dl>

</div>
</div>
<a class="anchor" id="ae894b44305a308a004e2d9b243e4cf31"></a><!-- doxytag: member="cMainData::pf_isDateInRC" ref="ae894b44305a308a004e2d9b243e4cf31" args="($strDay, $numDateTZ)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pf_isDateInRC </td>
          <td>(</td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>strDay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&#160;</td>
          <td class="paramname"> <em>numDateTZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check if given date is in Recent Changes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">$strDay</td><td>The day for the select </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">$numDateTZ</td><td>A project timezone at that date</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>1 if start time is within RC table</li>
<li>2 if end time is within RC table</li>
<li>0 otherwise </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a66b67d356902020dd46c7a1748fa8c69"></a><!-- doxytag: member="cMainData::pf_throwSQLError" ref="a66b67d356902020dd46c7a1748fa8c69" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pf_throwSQLError </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Throw SQL Error. </p>
<p>Call after unsuccessful query execution. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>lib/data.class.php</li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
